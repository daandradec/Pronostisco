{% extends 'core/app.html' %}

{% block title %}Entrada de Datos{% endblock %}

{% block styles %}
    {% load static %}   
    <link rel="stylesheet" href="{% static 'core/css/pronosimple/inputdatapronosimple.css' %}">
    <link rel="stylesheet" href="{% static 'core/vendor/table-excel/table-excel.css' %}">
    <link rel="stylesheet" href="{% static 'core/vendor/bootstrap-4.1.3/css/btn.css' %}">  
    <link rel="stylesheet" href="{% static 'core/vendor/input-file-drag-drop/input-file-drag-drop.css' %}">
{% endblock %}

{% block navigator %}
    <p style="margin: 0 0 !important;padding: 0 0 !important;">
        <a href="{% url 'alphapronosinputdata' %}{{parameters}}" class="active" language="true">Entrada de Datos</a> <i class="fas fa-angle-double-right"></i> <a href="{% url 'alphapronosgraph' %}{{parameters}}" class="{% if not data %}disabled{% endif %}" language="true">Pronósticos</a>
    </p>
{% endblock %}

{% block content %}
    {% load get_request_parameters %}
    {% get_current_parameters as parameters %}
    <section class="mt-4 mb-5">

        <div class="text-center">
            <br>
            <h5 class="font-alegreya-sans font-size-24px my-3" style="color:#898989;" language="true">Bienvenido Usuario, en esta sección tendrá la posibilidad de hacer el ingreso de sus registros de venta para poder hacer el pronostico</h5>
            <br>
        </div>
        
        <div class="container-fluid">
            <div class="row">

                <div class="col-xl-3 col-lg-6 col-md-12 col-sm-12 center mt-2">
                    <div class="rounded" style="background-image:url({% static 'core/img/background-02.jpg' %});background-size: 100% 100%;width:100%;height:100%;min-height:250px;"></div>               
                </div>

                <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12 center mt-2">
                
                    <div id="drag-cloud" class="text-center">
                        <i class="fas fa-cloud-upload-alt mt-4"></i>
                        <p class="mt-1" language="true">Arrastra los archivos .xlsx, .xls, .xlsm, .csv aquí</p>
                        <form action="{% url 'alphapronosgraph' %}{{parameters}}" method="POST" enctype="multipart/form-data">
                            {% csrf_token %}
                            <div class="form-group mt-2">
                                <label for="file_input" class="btn btn-info" language="true">Cargar Archivo</label>
                                <input type="file" name="file_input" id="file_input" style="display:none;">  
                                <div id="label_output_file"></div>
                            </div>
                            <div class="form-group mt-2">
                                <input type="submit" id="drag-cloud-button" class="btn btn-outline-success" value="Enviar" disabled="disabled">  
                            </div>                        
                        </form>  
                    </div>         
                </div>

                <div class="col-xl-3 col-lg-12 col-md-12 col-sm-12 center mt-2">
                    <div class="card shadow" style="min-width:300px;max-width:90%;">
                        <div class="card-body text-center border border-info">
                        <i class="fas fa-file-excel text-body" style="font-size:50px;"></i>
                        <h5 class="card-title mt-2" language="true">
                            ¡ IMPORTANTE !
                        </h5>
                        <p class="card-text text-justify" language="true">El formato de los datos debe ser una hoja de excel donde a cada celda le corresponda un valor en pesos</p>
                        <button class="btn btn-outline-primary" data-toggle="modal" data-target="#modalExample" language="true">Ver Ejemplo</button>
                        </div>
                    </div>                 
                </div>

            </div>
        </div>
    </section>

    {% if session_message %}
        <section class="mt-3 mb-3">
            <div class="alert alert-danger alert-dismissible fade show" role="alert">
                {{session_message}}
                <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
        </section>   
    {% endif %}

    <section class="text-center" style="margin-top:100px;margin-bottom:25px;background-image:url({% static 'core/img/background-04.png' %});">
        <hr>
        <br><br>
        <h5 class="font-alegreya-sans font-size-24px my-3" style="color:#898989;" language="true">Si no dispones de un archivo de Excel puedes optar por crear tu entrada de datos a partir de nuestra tabla</h5>
        <button class="btn btn-outline-secondary font-weight-bold font-alegreya-sans mt-2 mb-2" id="button-create-table" language="true">CREAR LA TABLA</button>
        <br><br>
        <hr>
    </section>

    <section id="section-table" style="display:none;" class="mb-5 mt-5">
        <section class="mt-4 mb-4">
            <ul class="nav nav-tabs" id="nav-tab" role="tablist">
                <li role="presentation" class="ml-5 d-flex section-nav-brand">
                    <div class="hr-line-32"></div>
                    <h4 style="height:100%;padding-top:3px;color:#939393;text-shadow: 0px 0px 1px #8ec6f5;" class="font-quicksand font-size-28px ml-1" language="true">PERIODO DE TIEMPO</h4>
                    <div class="hr-line-32 display-only-smm"></div>
                </li>
                <li role="presentation" class="active">
                    <a href="#table1" id="navtab1" data-toggle="tab" role="tab" aria-controls="table1" class="font-quicksand font-size-20px"><span language="true">Año/Mes</span></a>
                </li> 
                <li role="presentation">
                    <a href="#table2" id="navtab2" data-toggle="tab" role="tab" aria-controls="table2" class="font-quicksand font-size-20px"><span language="true">Semana/Dia</span></a>
                </li>                
            </ul>
        </section>

        <section style="width:95%;margin: 0 auto;" id="table-excel">
            <div class="tab-content">
                <!-- Table 1 -->
                    <div class="tab-pane active" id="table1" role="tabpanel">

                        <div class="table-responsive">
                            <table class="table table-bordered">
                                <thead>
                                    <tr>                          
                                    <th language="true">Año / Mes</th>
                                    <th language="true">Enero</th>
                                    <th language="true">Febrero</th>
                                    <th language="true">Marzo</th>
                                    <th language="true">Abril</th>
                                    <th language="true">Mayo</th>
                                    <th language="true">Junio</th>
                                    <th language="true">Julio</th>
                                    <th language="true">Agosto</th>
                                    <th language="true">Septiembre</th>
                                    <th language="true">Octubre</th>
                                    <th language="true">Noviembre</th>
                                    <th language="true">Diciembre</th>                     
                                    </tr>                
                                </thead>
                                <tbody>
                                    <tr>
                                    <td><button class="btn btn-sm float-left" onclick="removeRow(this)"><i class="fas fa-cut" style="color:red"></i></button>1</td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>       
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>   
                                    <td></td>          
                                    </tr>   
                                    <tr>
                                    <td><button class="btn btn-sm float-left" onclick="removeRow(this)"><i class="fas fa-cut" style="color:red"></i></button>2</td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>       
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>   
                                    <td></td>          
                                    </tr>                                                  
                                </tbody>
                            </table>



                        </div>
                    </div>
            
                <!-- Table 2 -->
                <div class="tab-pane" id="table2" role="tabpanel">
                    <div class="table-responsive">
                        <table class="table table-bordered">
                            <thead>
                                <tr>                          
                                    <th language="true">Semana / Día</th>
                                    <th language="true">Lunes</th>
                                    <th language="true">Martes</th>
                                    <th language="true">Miércoles</th>
                                    <th language="true">Jueves</th>
                                    <th language="true">Viernes</th>
                                    <th language="true">Sábado</th>
                                    <th language="true">Domingo</th>                      
                                </tr>                
                                </thead>
                            <tbody>
                                <tr>
                                    <td><button class="btn btn-sm float-left" onclick="removeRow(this)"><i class="fas fa-cut" style="color:red"></i></button>1</td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>                    
                                </tr>  
                                <tr>
                                    <td><button class="btn btn-sm float-left" onclick="removeRow(this)"><i class="fas fa-cut" style="color:red"></i></button>2</td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>                    
                                </tr>                                                       
                            </tbody>
                        </table>
                    </div>

                </div>
            </div>

            <button class="btn btn-secondary btn-block mt-2" id="button-table-excel"><i class="fas fa-plus"></i></button>  
            
            <section style="margin-top:30px;" class="text-center">
                <button class="btn btn-info font-alegreya-sans font-size-20px" id="button-send-table" style="width:35%;border-radius:24px;" language="true">CREAR ENTRADA DE DATOS<i class="fas fa-arrow-alt-circle-right ml-2"></i></button>  
            </section>  

        </section>
    </section>
{% endblock %}

{% block modal %}
    {% load static %}  
    <div class="modal fade" id="modalExample" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" style="background: rgba(0,0,0,0.75) !important;">
        <div class="modal-dialog" role="document" style="width: 80% !important;max-width: 80% !important;">
            <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel" language="true">EJEMPLO ENTRADA</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <section class="text-center">
                    <img src="{% static 'core/img/example.PNG' %}" width="100%">   
                    <p class="text-muted"><small language="true">Ejemplo de Entrada 1</small></p>
                    <img src="{% static 'core/img/example_2.PNG' %}" width="60%">
                    <p class="text-muted"><small language="true">Ejemplo de Entrada 2</small></p>
                </section>
                
                <section class="mt-4">
                    <div class="container">
                        <h1 class="text-center" language="true">Información Importante</h1>
                        <p class="text-justify" language="true">Primer cosa a considerar es que por el momento solo se aceptan periodos de Años/Meses o Semanas/Días tal 
                            y como se muestra en las imágenes de ejemplo, se aconseja empezar desde la columna A y la fila 1 en su 
                            archivo de excel, y solo se acepta un limite mínimo de 2 filas ya sea en años o semanas y un máximo de 7,
                             ademas los Formatos de Archivos de Excel Permitidos son .xls, .xlsm,.xlsx, y .csv</p>
                    </div>
                </section>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
            </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block scripts %}
    <script>
        var TOKEN = "{{csrf}}"
        var POST_ROUTE = "{% url 'alphapronosgraph' %}{{parameters}}"
    </script>

    {% load static %}
    <script src="{% static 'core/vendor/language-component/inputdatapronosimple/language-dataset.js' %}"></script>
    <script src="{% static 'core/vendor/table-excel/table-excel.js' %}"></script>
    <script src="{% static 'core/vendor/table-excel/table-excel-request-data.js' %}"></script>   
    <script src="{% static 'core/vendor/input-file-drag-drop/input-file-drag-drop.js' %}"></script>
    <script src="{% static 'core/js/validate-input-file.js' %}"></script>
    
    <script>
        $(document).ready(function(){
            $('#modalExample').modal('hide')      
        });      
    </script>

    <script>
        $("#button-create-table").click(function(e){
            $("#section-table").attr('style', 'display: block;')
            $(e.target).attr('style','display: none;')
        });
    </script> 
{% endblock %}